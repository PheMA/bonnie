<div class="patient-bank">

  <div class="bank-measure">
    <h1>{{cms_id}}</h1>
    <div class="panel">
      {{view bankLogicView}}
    </div>
  </div>

  <div class="bank-patients">    
    <h1>Filters</h1>
    {{!-- TODO: show added filters --}}
    {{!-- {{#collection patientFilters class="existing-filters"}} --}}
      <span class="added-filter">
        Existing 
        {{ patient_filter }}
        {{#button "removeFilter" class="btn btn-link close delete"}}&times; <span class="sr-only">Delete</span>{{/button}}
      </span>
    {{!-- {{/collection}} --}}

    <div class="patients-filtering">
      <div class="patients-filter-select">
        <select id="filters" name="patients-filter" class="form-control selectBoxIt-native">
          {{!-- TODO: show relevant populations for current measure --}}
          <option>Initial patient population</option>
          <option>Denominator</option>
          <option>Numerator</option>
          <option>Denominator exception</option>
        </select>
      </div>

      {{#button "addFilter" class="btn btn-primary" disabled="disabled"}}
        <i class="fa fa-plus" aria-hidden="true"></i>
        <span class="sr-only">add code</span>
      {{/button}}

      <input type="checkbox" name="expectation-set"> <label for="expectation-set">expectation set</label>
   
    </div>

    <div class="patients-results">
      <h1 class="pull-left">Results</h1>
        
      {{#button "exportBankPatients" class="btn btn-primary pull-right"}}Export<span class="sr-only"> patients selected from patient bank</span>{{/button}}

      {{#button "cloneBankPatients" class="btn btn-primary pull-right"}}Clone<span class="sr-only"> patients selected from patient bank</span>{{/button}}
      
    </div>
    
    {{#collection differences id="sharedResults" class="patient-results panel-group" item-context=differenceContext}}
      <div class="panel panel-default shared-patient">
        <div class="panel-heading">
          <div class="panel-title">
            <div class="patient">
              <div class="patient-status-icon status status-{{status}}">
                {{#if ../patientsListing}}
                  <label>
                    <span class="sr-only">Select {{patient.last}} {{patient.first}}</span>
                    <input type="checkbox" class="select-patient">
                  </label>
                {{else}}
                  {{#if done}}
                    {{#if match}}
                      <i class="fa fa-check" aria-hidden="true"></i><span class="sr-only">{{patient.last}} {{patient.first}}, patient passing</span>
                    {{else}}
                      <i class="fa fa-times" aria-hidden="true"></i><span class="sr-only">{{patient.last}} {{patient.first}}, patient failing</span>
                    {{/if}}
                  {{/if}}
                {{/if}}
              </div>
              <div class="patient-user-icon">
                <i class="fa fa-user" aria-hidden="true"></i><span class="sr-only">{{patient.last}} {{patient.first}}, patient result</span>
              </div>
              <div class="patient-btn">
                <a data-toggle="collapse" data-parent="#sharedResults" href="#toggle{{@cid}}" class="close">
                  <i class="fa fa-lg panel-chevron fa-angle-right expand-result-icon expand-result-icon-{{patient._id}}" aria-hidden="true"></i>
                  <span class="sr-only">{{patient.last}} {{patient.first}}, Toggle Logic Pass/Fail</span>
                </a>
              </div>
              <div class="patient-status status status-{{status}}">
                <span class="sr-only">{{patient.last}} {{patient.first}}, status </span>{{status}}
              </div>
              <div class="patient-name">
                <span class="sr-only">patient name: </span>{{patient.last}} {{patient.first}}
              </div>

            </div>
          </div>
        </div>
        <div id="toggle{{@cid}}" class="panel-collapse collapse">
          <div class="panel-body">
            {{template "population_calculation_results"}}
            {{#button "clonePatient" class="btn btn-primary"}}CLONE<span class="sr-only"> patient {{patient.last}} {{patient.first}}</span>{{/button}}
          </div>
        </div>
      </div>
    {{/collection}}

  </div>
</div>
